# 📊 财务报表智能分析系统 - 项目说明

## 🎯 项目概述

这是一个基于DeepSeek大模型的智能财务报表分析工具，能够自动处理长文本PDF财务报表（数百页），提取关键财务信息，生成结构化表格和可视化图表，并提供AI分析报告。

## ✨ 核心特性

### 1. 智能PDF处理
- ✅ 支持处理数百页的长文本PDF
- ✅ 自动分块处理，避免内存溢出
- ✅ 提取文本和表格数据
- ✅ 支持批量处理多个文件

### 2. AI财务信息提取
- ✅ 使用DeepSeek大模型智能识别财务指标
- ✅ 自动提取：收入、利润、资产、负债等关键数据
- ✅ 识别同比增长率等变化趋势
- ✅ 提取公司基本信息和报告期间

### 3. 自动生成表格
- ✅ 生成Excel格式的财务数据表格
- ✅ 支持CSV格式导出
- ✅ 多工作表组织（主要指标、现金流等）
- ✅ 支持多期数据对比

### 4. 数据可视化
- ✅ **柱状图**: 主要财务指标对比
- ✅ **饼图**: 现金流结构分布
- ✅ **雷达图**: 财务健康度评估
- ✅ **交互式仪表盘**: 综合数据展示（Plotly）

### 5. AI分析报告
- ✅ 自动生成财务分析报告
- ✅ 包含盈利能力、偿债能力、运营能力分析
- ✅ 识别主要风险和机会
- ✅ 提供专业的投资建议

### 6. 友好的用户界面
- ✅ **Web界面**: 基于Streamlit的现代化Web应用
- ✅ **命令行工具**: 支持批量处理和自动化
- ✅ **Python API**: 可集成到现有系统

## 🏗️ 系统架构

```
┌─────────────────────────────────────────────────────────┐
│                    用户界面层                              │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  │
│  │ Web应用      │  │ 命令行工具    │  │ Python API   │  │
│  │ (Streamlit)  │  │ (CLI)        │  │              │  │
│  └──────────────┘  └──────────────┘  └──────────────┘  │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                    工作流编排层                            │
│              ┌──────────────────────┐                    │
│              │  FinancialWorkflow   │                    │
│              │  (流程控制和协调)      │                    │
│              └──────────────────────┘                    │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                    核心功能层                              │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌─────────┐ │
│  │ PDF提取  │  │ AI Agent │  │ 表格生成 │  │ 可视化  │ │
│  │          │→ │          │→ │          │→ │         │ │
│  └──────────┘  └──────────┘  └──────────┘  └─────────┘ │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                    基础服务层                              │
│  ┌──────────────┐              ┌──────────────┐         │
│  │ DeepSeek API │              │ 数据处理库    │         │
│  │ (LLM服务)    │              │ (Pandas等)   │         │
│  └──────────────┘              └──────────────┘         │
└─────────────────────────────────────────────────────────┘
```

## 📁 项目结构

```
财务报表智能分析系统/
│
├── src/                          # 源代码目录
│   ├── __init__.py
│   ├── pdf_extractor.py          # PDF文本提取模块
│   ├── llm_client.py             # DeepSeek API客户端
│   ├── financial_agent.py        # 财务信息提取Agent
│   ├── table_generator.py        # 表格生成器
│   ├── visualizer.py             # 数据可视化器
│   └── workflow.py               # 工作流编排
│
├── app.py                        # Streamlit Web应用
├── cli.py                        # 命令行工具
├── test_demo.py                  # 演示脚本
│
├── requirements.txt              # Python依赖
├── .env                          # 环境变量配置
├── .env.example                  # 环境变量示例
├── .gitignore                    # Git忽略文件
│
├── start.bat                     # Windows启动脚本
├── start.sh                      # Linux/Mac启动脚本
│
├── README.md                     # 项目文档
├── 快速开始指南.md                # 快速入门
└── 项目说明.md                    # 本文件
```

## 🔄 工作流程

```
1. 上传PDF
   ↓
2. PDF文本提取（分块处理）
   ↓
3. 调用DeepSeek API提取财务信息
   ↓
4. 生成结构化数据（JSON）
   ↓
5. 并行处理：
   ├─→ 生成Excel表格
   ├─→ 生成可视化图表
   └─→ 生成AI分析报告
   ↓
6. 输出所有结果文件
```

## 🛠️ 技术栈

### 后端核心
- **Python 3.8+**: 主要编程语言
- **DeepSeek API**: 大语言模型服务
- **pdfplumber**: PDF文本提取
- **pandas**: 数据处理

### 数据可视化
- **matplotlib**: 静态图表生成
- **plotly**: 交互式图表
- **seaborn**: 高级可视化

### Web框架
- **Streamlit**: Web应用框架

### 数据导出
- **openpyxl**: Excel文件处理
- **xlsxwriter**: Excel高级功能

## 📊 提取的财务指标

### 公司基本信息
- 公司名称
- 报告期间
- 报告类型

### 损益表指标
- 营业收入（含同比增长）
- 营业成本
- 毛利润
- 净利润（含同比增长）
- 每股收益(EPS)

### 资产负债表指标
- 总资产
- 流动资产
- 固定资产
- 总负债
- 净资产
- 资产负债率

### 现金流量表指标
- 经营活动现金流
- 投资活动现金流
- 筹资活动现金流

### 财务比率
- 净资产收益率(ROE)
- 毛利率
- 净利率
- 流动比率
- 速动比率

## 🎨 可视化图表说明

### 1. 财务指标柱状图
- **用途**: 对比主要财务指标的绝对值
- **包含**: 营业收入、净利润、总资产
- **特点**: 直观展示规模差异

### 2. 现金流饼图
- **用途**: 展示三大现金流的结构
- **包含**: 经营、投资、筹资现金流
- **特点**: 百分比展示，易于理解

### 3. 财务健康度雷达图
- **用途**: 多维度评估财务状况
- **包含**: ROE、偿债能力等指标
- **特点**: 综合评价，一目了然

### 4. 交互式仪表盘
- **用途**: 综合展示所有关键数据
- **包含**: 多个子图表组合
- **特点**: 可交互、可缩放、可导出

## 🔐 安全性说明

### API密钥保护
- API密钥存储在 `.env` 文件中
- `.env` 已加入 `.gitignore`，不会上传到代码仓库
- Web界面支持密码输入框，不明文显示

### 数据隐私
- 所有处理都在本地进行
- 只有文本内容发送到DeepSeek API
- 不存储用户上传的原始PDF

## 📈 性能优化

### 1. 分块处理
- PDF按页数分块（默认10页/块）
- 避免一次性加载整个文件
- 减少内存占用

### 2. 并行处理
- 表格生成、可视化、报告生成可并行
- 提高整体处理速度

### 3. 缓存机制
- 提取的文本可缓存
- 避免重复处理

### 4. 错误处理
- 完善的异常捕获
- 失败时提供默认值
- 不会因单个模块失败而中断

## 🚀 扩展性

### 支持的扩展方向

1. **更多财务指标**
   - 修改 `llm_client.py` 中的提示词
   - 添加新的数据字段

2. **更多图表类型**
   - 在 `visualizer.py` 中添加新方法
   - 支持趋势图、对比图等

3. **多语言支持**
   - 调整提示词支持英文报表
   - 添加语言检测

4. **数据库存储**
   - 集成SQLite/PostgreSQL
   - 存储历史分析结果

5. **API服务**
   - 封装为REST API
   - 支持远程调用

## 📝 使用场景

### 1. 投资分析
- 快速分析上市公司财报
- 对比多家公司财务数据
- 生成投资决策报告

### 2. 企业尽调
- 批量处理目标公司财报
- 提取关键财务指标
- 生成尽调报告

### 3. 财务研究
- 提取历史财务数据
- 分析财务趋势
- 行业对比分析

### 4. 教学演示
- 展示AI在财务分析中的应用
- 自动化财务报表处理
- 数据可视化教学

## 🎓 学习价值

通过这个项目，您可以学习到：

1. **AI Agent开发**
   - 如何设计AI工作流
   - 如何使用LLM提取结构化数据
   - 如何处理LLM的输出

2. **数据处理**
   - PDF文本提取技术
   - 数据清洗和结构化
   - 表格生成和导出

3. **数据可视化**
   - matplotlib图表制作
   - plotly交互式图表
   - 仪表盘设计

4. **Web应用开发**
   - Streamlit应用开发
   - 文件上传和下载
   - 状态管理

5. **工程实践**
   - 模块化设计
   - 错误处理
   - 代码组织

## 🔮 未来规划

- [ ] 支持更多文件格式（Word、Excel等）
- [ ] 添加OCR支持扫描版PDF
- [ ] 实现多期财务数据对比
- [ ] 添加行业对标分析
- [ ] 支持自定义分析模板
- [ ] 集成更多可视化图表
- [ ] 提供API服务
- [ ] 添加用户认证和权限管理
- [ ] 支持团队协作功能
- [ ] 移动端适配

## 📞 技术支持

如有问题，请：
1. 查看 `README.md` 和 `快速开始指南.md`
2. 检查 `demo_output/` 中的示例输出
3. 查看源代码注释
4. 运行 `test_demo.py` 验证环境

## 📄 许可证

MIT License - 可自由使用、修改和分发

---

**项目版本**: 1.0.0  
**创建日期**: 2025-10-28  
**开发者**: AI Agent  
**技术支持**: DeepSeek AI

