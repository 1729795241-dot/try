# 🚀 快速开始指南

## 第一步：安装依赖

打开命令行（PowerShell或CMD），进入项目目录，运行：

```bash
pip install -r requirements.txt
```

安装过程可能需要几分钟，请耐心等待。

## 第二步：查看演示效果

运行演示脚本，查看系统功能：

```bash
python test_demo.py
```

这会在 `demo_output/` 目录生成示例文件：
- ✅ Excel财务数据表格
- ✅ 可视化图表（柱状图、饼图、交互式仪表盘）
- ✅ 分析报告
- ✅ JSON数据

**打开这些文件查看效果！**

## 第三步：启动Web应用

### Windows用户

双击运行 `start.bat` 文件

或在命令行运行：
```bash
streamlit run app.py
```

### Mac/Linux用户

在终端运行：
```bash
chmod +x start.sh
./start.sh
```

或直接运行：
```bash
streamlit run app.py
```

### 访问应用

启动后，浏览器会自动打开，或手动访问：
```
http://localhost:8501
```

## 第四步：分析真实PDF

### 方法1：使用Web界面（推荐）

1. 在Web界面点击"上传分析"标签
2. 上传PDF财务报表文件
3. 点击"开始分析"按钮
4. 等待处理完成（可能需要几分钟）
5. 在"查看结果"标签查看分析结果
6. 下载生成的Excel、报告和图表

### 方法2：使用命令行

```bash
# 分析单个PDF
python cli.py your_report.pdf

# 分析多个PDF
python cli.py report1.pdf report2.pdf

# 指定输出目录
python cli.py report.pdf -o my_results
```

## 📊 输出文件说明

所有结果保存在 `output/` 目录（或您指定的目录）：

| 文件类型 | 说明 |
|---------|------|
| `*_财务数据.xlsx` | Excel格式的财务数据表格 |
| `*_分析报告.txt` | AI生成的财务分析报告 |
| `*_数据.json` | 结构化的原始数据 |
| `*_财务指标柱状图.png` | 主要指标对比图 |
| `*_现金流饼图.png` | 现金流结构图 |
| `*_雷达图.png` | 财务健康度评估 |
| `*_交互式仪表盘.html` | 可交互的综合仪表盘 |

## 🔧 常见问题

### Q1: 安装依赖时出错？

**A**: 确保Python版本 >= 3.8，尝试升级pip：
```bash
python -m pip install --upgrade pip
pip install -r requirements.txt
```

### Q2: API调用失败？

**A**: 检查 `.env` 文件中的API密钥是否正确：
```env
DEEPSEEK_API_KEY=sk-f714f944a8a04ed3b13ea5894bead929
```

### Q3: PDF提取失败？

**A**: 确保PDF文件：
- 不是扫描版（需要是可复制文本的PDF）
- 文件没有损坏
- 文件大小不超过200MB

### Q4: 中文显示乱码？

**A**: 图表中文显示问题，系统会自动尝试使用SimHei字体。如果仍有问题，可以：
- Windows: 确保系统有中文字体
- Mac/Linux: 安装中文字体包

### Q5: 处理速度慢？

**A**: 
- 长PDF（几百页）处理需要时间，请耐心等待
- 系统会分块处理，避免超时
- 可以在代码中调整 `chunk_size` 参数

## 💡 使用技巧

### 1. 批量处理

如果有多个财务报表需要分析：

```bash
python cli.py report1.pdf report2.pdf report3.pdf -o batch_results
```

### 2. 自定义提示词

编辑 `src/llm_client.py` 中的提示词，可以：
- 提取更多财务指标
- 调整分析报告风格
- 添加行业对比分析

### 3. 调整可视化

编辑 `src/visualizer.py`，可以：
- 修改图表颜色和样式
- 添加新的图表类型
- 调整图表尺寸

### 4. 导出格式

表格支持Excel和CSV两种格式：

```python
# 在代码中修改
table_gen.generate_financial_table(data, output_format="csv")
```

## 📚 进阶使用

### 作为Python库使用

```python
from src.workflow import FinancialWorkflow

# 创建工作流
workflow = FinancialWorkflow(
    api_key="your_api_key",
    output_dir="my_output"
)

# 处理PDF
result = workflow.run("report.pdf")

# 获取财务数据
financial_data = result['financial_data']
print(financial_data)
```

### 集成到现有系统

```python
from src.financial_agent import FinancialAgent
from src.pdf_extractor import PDFExtractor

# 只提取PDF文本
extractor = PDFExtractor()
text = extractor.extract_text("report.pdf")

# 只提取财务信息
agent = FinancialAgent(api_key="your_key")
result = agent.process_pdf("report.pdf")
```

## 🎯 下一步

1. ✅ 尝试分析真实的财务报表PDF
2. ✅ 查看生成的各种图表和报告
3. ✅ 根据需要调整配置和提示词
4. ✅ 集成到您的工作流程中

## 📞 获取帮助

- 查看 `README.md` 了解详细文档
- 检查 `demo_output/` 中的示例输出
- 查看源代码中的注释和文档字符串

---

**祝您使用愉快！** 🎉

