╔══════════════════════════════════════════════════════════════╗
║          📊 财务报表智能分析系统 - 使用说明                      ║
╚══════════════════════════════════════════════════════════════╝

🎉 恭喜！系统已经完全搭建完成并测试通过！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📋 目录
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 快速开始
2. 功能介绍
3. 使用方法
4. 输出文件说明
5. 常见问题
6. 技术支持

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🚀 1. 快速开始（3步即可使用）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

步骤1: 安装依赖
   打开命令行，运行：
   pip install -r requirements.txt

步骤2: 查看演示效果
   运行演示脚本：
   python test_demo.py
   
   这会生成示例文件在 demo_output/ 目录，包括：
   ✓ Excel财务数据表格
   ✓ 可视化图表（柱状图、饼图、交互式仪表盘）
   ✓ AI分析报告
   ✓ JSON数据

步骤3: 启动Web应用
   Windows用户：双击 start.bat
   或运行命令：streamlit run app.py
   
   然后在浏览器访问：http://localhost:8501

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✨ 2. 功能介绍
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

本系统是一个基于DeepSeek大模型的智能财务分析工具，具有以下功能：

📄 PDF文本提取
   • 支持处理数百页的长文本PDF
   • 自动分块处理，避免内存溢出
   • 智能提取文本和表格

🔍 智能信息提取
   • 自动识别公司名称、报告期间
   • 提取营业收入、净利润、总资产等关键指标
   • 识别同比增长率等变化趋势

📊 自动生成表格
   • 生成Excel格式的财务数据表格
   • 包含主要财务指标和现金流量表
   • 支持CSV格式导出

📈 数据可视化
   • 财务指标柱状图：对比收入、利润、资产
   • 现金流饼图：展示三大现金流结构
   • 财务健康度雷达图：多维度评估
   • 交互式仪表盘：综合数据展示

🤖 AI分析报告
   • 自动生成专业的财务分析报告
   • 包含盈利能力、偿债能力、运营能力分析
   • 识别主要风险和机会

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📖 3. 使用方法
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

方法一：Web界面（推荐，最简单）
────────────────────────────────────────────────────────

1. 启动应用：
   双击 start.bat（Windows）
   或运行：streamlit run app.py

2. 在浏览器中打开：http://localhost:8501

3. 操作步骤：
   ① 点击"上传分析"标签
   ② 上传PDF财务报表文件
   ③ 点击"开始分析"按钮
   ④ 等待处理完成（可能需要几分钟）
   ⑤ 在"查看结果"标签查看分析结果
   ⑥ 下载生成的Excel、报告和图表

方法二：命令行工具（适合批量处理）
────────────────────────────────────────────────────────

分析单个PDF：
   python cli.py your_report.pdf

分析多个PDF：
   python cli.py report1.pdf report2.pdf report3.pdf

指定输出目录：
   python cli.py report.pdf -o my_results

显示详细信息：
   python cli.py report.pdf -v

方法三：Python代码调用（适合集成）
────────────────────────────────────────────────────────

from src.workflow import FinancialWorkflow

# 创建工作流
workflow = FinancialWorkflow(
    api_key="your_api_key",
    output_dir="output"
)

# 处理PDF
result = workflow.run("report.pdf")

# 获取结果
financial_data = result['financial_data']
print(financial_data)

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📁 4. 输出文件说明
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

所有结果保存在 output/ 目录（或您指定的目录）：

文件类型                          说明
────────────────────────────────────────────────────────
{公司名称}_财务数据.xlsx          Excel格式的财务数据表格
                                 包含主要指标和现金流量表

{公司名称}_分析报告.txt           AI生成的财务分析报告
                                 包含财务状况评价和建议

{公司名称}_数据.json              结构化的原始数据
                                 JSON格式，便于程序处理

{公司名称}_财务指标柱状图.png     主要财务指标对比图
                                 展示收入、利润、资产

{公司名称}_现金流饼图.png         现金流结构分布图
                                 展示三大现金流占比

{公司名称}_雷达图.png             财务健康度评估图
                                 多维度财务指标评估

{公司名称}_交互式仪表盘.html      综合财务数据仪表盘
                                 可交互、可缩放的HTML页面

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❓ 5. 常见问题
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Q1: 安装依赖时出错？
A:  确保Python版本 >= 3.8，尝试：
    python -m pip install --upgrade pip
    pip install -r requirements.txt

Q2: API调用失败？
A:  检查 .env 文件中的API密钥是否正确：
    DEEPSEEK_API_KEY=sk-f714f944a8a04ed3b13ea5894bead929

Q3: PDF提取失败？
A:  确保PDF文件：
    • 不是扫描版（需要是可复制文本的PDF）
    • 文件没有损坏
    • 文件大小不超过200MB

Q4: 处理速度慢？
A:  长PDF（几百页）处理需要时间，这是正常的
    系统会分块处理，请耐心等待

Q5: 图表中文显示乱码？
A:  系统会自动尝试使用中文字体
    Windows系统通常没有问题

Q6: 提取的数据不准确？
A:  AI提取的数据仅供参考，重要决策请人工核验
    可以调整提示词以提高准确性

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
💡 6. 使用技巧
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

技巧1: 批量处理
   如果有多个财务报表，使用命令行批量处理更高效：
   python cli.py *.pdf -o batch_results

技巧2: 查看演示
   不确定效果？先运行演示脚本：
   python test_demo.py
   查看 demo_output/ 目录中的示例输出

技巧3: 自定义分析
   编辑 src/llm_client.py 中的提示词，可以：
   • 提取更多财务指标
   • 调整分析报告风格
   • 添加行业对比分析

技巧4: 调整可视化
   编辑 src/visualizer.py，可以：
   • 修改图表颜色和样式
   • 添加新的图表类型
   • 调整图表尺寸

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📚 7. 文档资源
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

README.md              完整的项目文档
快速开始指南.md        详细的入门教程
项目说明.md            系统架构和技术说明
使用说明.txt           本文件

demo_output/           演示输出示例
src/                   源代码（有详细注释）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 8. 下一步建议
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. ✅ 运行 python test_demo.py 查看演示效果
2. ✅ 启动Web应用，熟悉界面操作
3. ✅ 准备一份真实的PDF财务报表进行测试
4. ✅ 查看生成的各种图表和报告
5. ✅ 根据需要调整配置和提示词

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📞 技术支持
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

遇到问题？
1. 查看本文档的"常见问题"部分
2. 查看 README.md 和 快速开始指南.md
3. 检查 demo_output/ 中的示例输出
4. 查看源代码中的注释和文档字符串

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

系统信息：
• 版本: 1.0.0
• 开发: AI Agent
• 模型: DeepSeek Chat
• 日期: 2025-10-28

祝您使用愉快！🎉

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

